{"ast":null,"code":"var _jsxFileName = \"/Users/Min/Desktop/expense-tracker/client/src/components/common/BarChart.jsx\";\nimport React, { useEffect, useRef } from 'react';\nimport * as d3 from 'd3';\nimport moment from 'moment';\n\nconst BarChart = ({\n  data: originalData,\n  keys,\n  select,\n  width,\n  height\n}) => {\n  const ref = useRef(null);\n  const weekList = moment.weekdays();\n  const monthList = moment.months();\n  const colorList = ['#f8777d', '#fff'];\n  useEffect(() => {\n    const data = originalData.forEach((data, index) => data[index].expense = Math.abs(data[index].expense));\n    const group = d3.select(ref.current); // const labels = data.map(d => d.text);\n\n    const labels = select === 0 ? weekList : select === 1 ? data.map(d => d.text) : monthList;\n    const stackGenerator = d3.stack().keys(keys);\n    console.log(data);\n    const layers = stackGenerator(data);\n    const extent = [0, d3.max(layers, layer => d3.max(layer, seq => Math.abs(seq[1])))];\n    const maxAmount = d3.max(data, d => Math.abs(d.amount));\n    const yScale = d3.scaleLinear().domain([0, maxAmount]).range([0, height - 15]);\n    const xScale = d3.scaleBand().domain(labels).range([0, width]);\n    const xAxis = d3.axisBottom(xScale).tickSize(0);\n    group.select('.x-axis').style('transform', `translateY(${+height - 14}px)`).style('color', 'white').call(xAxis).call(g => g.select(\".domain\").remove()).selectAll('.x-axis .tick text').call(t => t.each(function (d) {\n      const self = d3.select(this);\n      const s = self.text().split(' - ');\n      self.text('');\n      self.append(\"tspan\").attr(\"x\", 0).attr(\"dy\", \"1em\").text(select === 1 ? s[0] : s[0].slice(0, 3));\n      select === 1 && self.append(\"tspan\").attr(\"x\", 0).attr(\"dy\", \"1em\").text('- ' + s[1]);\n    }));\n    group.selectAll('.bar').data(data).join('rect').attr('class', 'bar').style('transform', 'scale(1, -1)').attr('x', d => xScale.bandwidth() / 2 - 3 + xScale(d.text)).attr('y', -height + 15).attr('width', 6).attr('height', 0).attr('fill', d => d.amount < 0 ? colorList[0] : colorList[1]).transition().duration(1000).attr('height', d => yScale(Math.abs(d.amount))); // eslint-disable-next-line\n  }, [originalData]);\n  return React.createElement(\"svg\", {\n    width: width,\n    height: height,\n    ref: ref,\n    style: {\n      margin: 'auto',\n      overflow: 'visible'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  }, React.createElement(\"g\", {\n    className: \"x-axis\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87\n    },\n    __self: this\n  }));\n};\n\nexport default BarChart;","map":{"version":3,"sources":["/Users/Min/Desktop/expense-tracker/client/src/components/common/BarChart.jsx"],"names":["React","useEffect","useRef","d3","moment","BarChart","data","originalData","keys","select","width","height","ref","weekList","weekdays","monthList","months","colorList","forEach","index","expense","Math","abs","group","current","labels","map","d","text","stackGenerator","stack","console","log","layers","extent","max","layer","seq","maxAmount","amount","yScale","scaleLinear","domain","range","xScale","scaleBand","xAxis","axisBottom","tickSize","style","call","g","remove","selectAll","t","each","self","s","split","append","attr","slice","join","bandwidth","transition","duration","margin","overflow"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport * as d3 from 'd3';\nimport moment from 'moment';\n\nconst BarChart = ({ data: originalData, keys, select, width, height }) => {\n  const ref = useRef(null);\n  const weekList = moment.weekdays();\n  const monthList = moment.months();\n  const colorList = [ '#f8777d', '#fff' ];\n\n  useEffect(() => {\n    const data = originalData.forEach((data, index) => data[index].expense = Math.abs(data[index].expense));\n    const group = d3.select(ref.current);\n    // const labels = data.map(d => d.text);\n    const labels = select === 0\n      ? weekList : select === 1 \n      ? data.map(d => d.text) : monthList;\n\n    const stackGenerator = d3.stack().keys(keys);\n    console.log(data)\n    const layers = stackGenerator(data);\n    \n    const extent = [0, d3.max(layers, layer => d3.max(layer, seq => Math.abs(seq[1])))];\n\n    const maxAmount = d3.max(data, d => Math.abs(d.amount));\n\n    const yScale = d3\n      .scaleLinear()\n      .domain([0, maxAmount])\n      .range([0, height - 15]);\n\n    const xScale = d3\n      .scaleBand()\n      .domain(labels)\n      .range([0, width]);\n    \n    const xAxis = d3\n      .axisBottom(xScale)\n      .tickSize(0);\n\n    group\n      .select('.x-axis')\n      .style('transform', `translateY(${+height - 14}px)`)\n      .style('color', 'white')\n      .call(xAxis)\n      .call(g => g.select(\".domain\").remove())\n      .selectAll('.x-axis .tick text')\n      .call(t => t.each(function(d) {\n        const self = d3.select(this);\n        const s = self.text().split(' - ');\n        self.text('');\n        self.append(\"tspan\")\n          .attr(\"x\", 0)\n          .attr(\"dy\",\"1em\")\n          .text(select === 1 ? s[0] : s[0].slice(0, 3));\n        select === 1 && self.append(\"tspan\")\n          .attr(\"x\", 0)\n          .attr(\"dy\",\"1em\")\n          .text('- ' + s[1]);\n      }));\n\n    group\n      .selectAll('.bar')\n      .data(data)\n      .join('rect')\n      .attr('class', 'bar')\n      .style('transform', 'scale(1, -1)')\n      .attr('x', d => xScale.bandwidth() / 2 - 3 + xScale(d.text))\n      .attr('y', -height + 15)\n      .attr('width', 6)\n      .attr('height', 0)\n      .attr('fill', d => d.amount < 0 ? colorList[0] : colorList[1])\n      .transition()\n      .duration(1000)\n      .attr('height', d => yScale(Math.abs(d.amount)));\n\n  // eslint-disable-next-line\n  }, [originalData])\n\n  return ( \n    <svg\n      width={width} \n      height={height} \n      ref={ref}\n      style={{ margin: 'auto', overflow: 'visible' }}\n    >\n      <g className='x-axis' />\n    </svg>\n  );\n}\n\nexport default BarChart;"]},"metadata":{},"sourceType":"module"}
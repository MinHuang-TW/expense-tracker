{"ast":null,"code":"var _jsxFileName = \"/Users/Min/Desktop/expense-tracker/client/src/components/common/BarChart.jsx\";\nimport React, { useEffect, useRef } from 'react';\nimport moment from 'moment';\nimport * as d3 from 'd3';\n\nconst BarChart = ({\n  data,\n  keys,\n  select,\n  width,\n  height\n}) => {\n  const ref = useRef(null);\n  const barWidth = 6;\n  const colorList = {\n    income: '#fff',\n    expense: '#f8777d'\n  };\n  const dayList = moment.weekdays();\n  const monthList = moment.months();\n  const weekList = [];\n  const firstDay = moment().startOf('month');\n  const lastDay = moment().endOf('month');\n  const monthRange = moment.range(firstDay, lastDay);\n\n  for (let mday of monthRange.by('days')) {\n    if (weekList.indexOf(mday.week()) === -1) {\n      weekList.push('Week ' + mday.week());\n    }\n  }\n\n  data.forEach(data => data['expense'] = Math.abs(data['expense']));\n  useEffect(() => {\n    const group = d3.select(ref.current);\n    const labels = select === 0 ? dayList : select === 1 ? weekList : monthList;\n    const stackGenerator = d3.stack().keys(keys).order(d3.stackOrderReverse);\n    const layers = stackGenerator(data);\n    const maxAmount = d3.max(layers, layer => d3.max(layer, seq => Math.abs(seq[1])));\n    const extent = [0, maxAmount];\n    const yScale = d3.scaleLinear().domain(extent).range([height, 0]);\n    const xScale = d3.scaleBand().domain(labels).range([0, width]);\n    const paddingLeft = (xScale.bandwidth() - barWidth) / 2;\n    const xAxis = d3.axisBottom(xScale).tickFormat(d => select === 1 ? d : d.slice(0, 3)).tickSize(0);\n    group.select('.x-axis').style('transform', `translateY(${height}px)`).style('color', 'white').call(xAxis).call(g => g.select('.domain').remove()).selectAll('.x-axis .tick text').attr('dy', '1em');\n    group.selectAll('.layer').data(layers).join('g').attr('class', 'layer').attr('fill', layer => colorList[layer.key]).selectAll('rect').data(layer => layer).join('rect').attr('x', seq => paddingLeft + xScale(seq.data.text)).attr('width', barWidth).attr('y', height).attr('height', 0).transition().duration(1000).attr('y', seq => yScale(seq[1])).attr('height', seq => yScale(seq[0]) - yScale(seq[1])); // eslint-disable-next-line\n  }, [data]);\n  return React.createElement(\"svg\", {\n    width: width,\n    height: height,\n    ref: ref,\n    style: {\n      margin: 'auto',\n      overflow: 'visible'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }, React.createElement(\"g\", {\n    className: \"x-axis\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }));\n};\n\nexport default BarChart;","map":{"version":3,"sources":["/Users/Min/Desktop/expense-tracker/client/src/components/common/BarChart.jsx"],"names":["React","useEffect","useRef","moment","d3","BarChart","data","keys","select","width","height","ref","barWidth","colorList","income","expense","dayList","weekdays","monthList","months","weekList","firstDay","startOf","lastDay","endOf","monthRange","range","mday","by","indexOf","week","push","forEach","Math","abs","group","current","labels","stackGenerator","stack","order","stackOrderReverse","layers","maxAmount","max","layer","seq","extent","yScale","scaleLinear","domain","xScale","scaleBand","paddingLeft","bandwidth","xAxis","axisBottom","tickFormat","d","slice","tickSize","style","call","g","remove","selectAll","attr","join","key","text","transition","duration","margin","overflow"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport moment from 'moment';\nimport * as d3 from 'd3';\n\nconst BarChart = ({ data, keys, select, width, height }) => {\n  const ref = useRef(null);\n  const barWidth = 6;\n  const colorList = { income: '#fff', expense: '#f8777d' };\n\n  const dayList = moment.weekdays();\n  const monthList = moment.months();\n  const weekList = [];\n\n  const firstDay = moment().startOf('month');\n  const lastDay = moment().endOf('month');\n  const monthRange = moment.range(firstDay, lastDay);\n  for (let mday of monthRange.by('days')) {\n    if (weekList.indexOf(mday.week()) === -1) {\n      weekList.push('Week ' + mday.week());\n    }\n  }\n  data.forEach((data) => (data['expense'] = Math.abs(data['expense'])));\n\n  useEffect(() => {\n    const group = d3.select(ref.current);\n    const labels = select === 0 ? dayList : select === 1 ? weekList : monthList;\n    const stackGenerator = d3.stack().keys(keys).order(d3.stackOrderReverse);\n    const layers = stackGenerator(data);\n    const maxAmount = d3.max(layers, (layer) =>\n      d3.max(layer, (seq) => Math.abs(seq[1]))\n    );\n    const extent = [0, maxAmount];\n\n    const yScale = d3.scaleLinear().domain(extent).range([height, 0]);\n    const xScale = d3.scaleBand().domain(labels).range([0, width]);\n    const paddingLeft = (xScale.bandwidth() - barWidth) / 2;\n    const xAxis = d3\n      .axisBottom(xScale)\n      .tickFormat((d) => (select === 1 ? d : d.slice(0, 3)))\n      .tickSize(0);\n\n    group\n      .select('.x-axis')\n      .style('transform', `translateY(${height}px)`)\n      .style('color', 'white')\n      .call(xAxis)\n      .call((g) => g.select('.domain').remove())\n      .selectAll('.x-axis .tick text')\n      .attr('dy', '1em');\n\n    group\n      .selectAll('.layer')\n      .data(layers)\n      .join('g')\n      .attr('class', 'layer')\n      .attr('fill', (layer) => colorList[layer.key])\n      .selectAll('rect')\n      .data((layer) => layer)\n      .join('rect')\n      .attr('x', (seq) => paddingLeft + xScale(seq.data.text))\n      .attr('width', barWidth)\n      .attr('y', height)\n      .attr('height', 0)\n      .transition()\n      .duration(1000)\n      .attr('y', (seq) => yScale(seq[1]))\n      .attr('height', (seq) => yScale(seq[0]) - yScale(seq[1]));\n\n    // eslint-disable-next-line\n  }, [data]);\n\n  return (\n    <svg\n      width={width}\n      height={height}\n      ref={ref}\n      style={{ margin: 'auto', overflow: 'visible' }}\n    >\n      <g className='x-axis' />\n    </svg>\n  );\n};\n\nexport default BarChart;\n"]},"metadata":{},"sourceType":"module"}
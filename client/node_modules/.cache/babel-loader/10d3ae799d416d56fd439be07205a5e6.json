{"ast":null,"code":"var _jsxFileName = \"/Users/Min/Desktop/expense-tracker/client/src/components/common/BarChart.jsx\";\nimport React, { useEffect, useRef } from 'react';\nimport * as d3 from 'd3';\nimport moment from 'moment';\n\nconst BarChart = ({\n  data,\n  keys,\n  select,\n  width,\n  height\n}) => {\n  const ref = useRef(null);\n  const weekList = moment.weekdays();\n  const monthList = moment.months();\n  const colorList = ['#fff', '#f8777d'];\n  useEffect(() => {\n    const group = d3.select(ref.current); // const labels = data.map(d => d.text);\n\n    const labels = select === 0 ? weekList : select === 1 ? data.map(d => d.text) : monthList;\n    data.forEach(data => data['expense'] = Math.abs(data['expense']));\n    const stackGenerator = d3.stack().keys(keys);\n    const layers = stackGenerator(data);\n    const extent = [0, d3.max(layers, layer => d3.max(layer, seq => Math.abs(seq[1])))];\n    console.log(extent); // const maxAmount = d3.max(data, (d) => Math.abs(d.amount));\n\n    const yScale = d3.scaleLinear().domain(extent).range([0, height - 15]);\n    const xScale = d3.scaleBand().domain(labels).range([0, width]);\n    const xAxis = d3.axisBottom(xScale).tickSize(0);\n    group.select('.x-axis').style('transform', `translateY(${+height - 14}px)`).style('color', 'white').call(xAxis).call(g => g.select('.domain').remove()).selectAll('.x-axis .tick text').call(t => t.each(function (d) {\n      const self = d3.select(this);\n      const s = self.text().split(' - ');\n      self.text('');\n      self.append('tspan').attr('x', 0).attr('dy', '1em').text(select === 1 ? s[0] : s[0].slice(0, 3));\n      select === 1 && self.append('tspan').attr('x', 0).attr('dy', '1em').text('- ' + s[1]);\n    }));\n    group.selectAll('.layer').data(layers).join('g').attr('class', 'layer').attr('fill', (layer, index) => colorList[layer.index]).selectAll('rect').data(layer => layer).join('rect').style('transform', 'scale(1, -1)').attr('x', seq => xScale.bandwidth() / 2 - 3 + xScale(seq.data.text)).attr('y', -height + 15).attr('width', 6).attr('height', seq => yScale(seq[1]) - yScale(seq[0])); // group\n    //   .selectAll('.bar')\n    //   .data(data)\n    //   .join('rect')\n    //   .attr('class', 'bar')\n    //   .style('transform', 'scale(1, -1)')\n    //   .attr('x', (d) => xScale.bandwidth() / 2 - 3 + xScale(d.text))\n    //   .attr('y', -height + 15)\n    //   .attr('width', 6)\n    //   .attr('height', 0)\n    //   .attr('fill', (d) => (d.amount < 0 ? colorList[0] : colorList[1]))\n    //   .transition()\n    //   .duration(1000)\n    //   .attr('height', (d) => yScale(Math.abs(d.amount)));\n    // eslint-disable-next-line\n  }, [data]);\n  return React.createElement(\"svg\", {\n    width: width,\n    height: height,\n    ref: ref,\n    style: {\n      margin: 'auto',\n      overflow: 'visible'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, React.createElement(\"g\", {\n    className: \"x-axis\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  }));\n};\n\nexport default BarChart;","map":{"version":3,"sources":["/Users/Min/Desktop/expense-tracker/client/src/components/common/BarChart.jsx"],"names":["React","useEffect","useRef","d3","moment","BarChart","data","keys","select","width","height","ref","weekList","weekdays","monthList","months","colorList","group","current","labels","map","d","text","forEach","Math","abs","stackGenerator","stack","layers","extent","max","layer","seq","console","log","yScale","scaleLinear","domain","range","xScale","scaleBand","xAxis","axisBottom","tickSize","style","call","g","remove","selectAll","t","each","self","s","split","append","attr","slice","join","index","bandwidth","margin","overflow"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport * as d3 from 'd3';\nimport moment from 'moment';\n\nconst BarChart = ({ data, keys, select, width, height }) => {\n  const ref = useRef(null);\n  const weekList = moment.weekdays();\n  const monthList = moment.months();\n  const colorList = ['#fff', '#f8777d'];\n\n  useEffect(() => {\n    const group = d3.select(ref.current);\n    // const labels = data.map(d => d.text);\n    const labels =\n      select === 0\n        ? weekList\n        : select === 1\n        ? data.map((d) => d.text)\n        : monthList;\n\n    data.forEach((data) => (data['expense'] = Math.abs(data['expense'])));\n    const stackGenerator = d3.stack().keys(keys);\n    const layers = stackGenerator(data);\n    const extent = [\n      0,\n      d3.max(layers, (layer) => d3.max(layer, (seq) => Math.abs(seq[1]))),\n    ];\n    console.log(extent);\n    // const maxAmount = d3.max(data, (d) => Math.abs(d.amount));\n\n    const yScale = d3\n      .scaleLinear()\n      .domain(extent)\n      .range([0, height - 15]);\n\n    const xScale = d3.scaleBand().domain(labels).range([0, width]);\n\n    const xAxis = d3.axisBottom(xScale).tickSize(0);\n\n    group\n      .select('.x-axis')\n      .style('transform', `translateY(${+height - 14}px)`)\n      .style('color', 'white')\n      .call(xAxis)\n      .call((g) => g.select('.domain').remove())\n      .selectAll('.x-axis .tick text')\n      .call((t) =>\n        t.each(function (d) {\n          const self = d3.select(this);\n          const s = self.text().split(' - ');\n          self.text('');\n          self\n            .append('tspan')\n            .attr('x', 0)\n            .attr('dy', '1em')\n            .text(select === 1 ? s[0] : s[0].slice(0, 3));\n          select === 1 &&\n            self\n              .append('tspan')\n              .attr('x', 0)\n              .attr('dy', '1em')\n              .text('- ' + s[1]);\n        })\n      );\n\n    group\n      .selectAll('.layer')\n      .data(layers)\n      .join('g')\n      .attr('class', 'layer')\n      .attr('fill', (layer, index) => colorList[layer.index])\n      .selectAll('rect')\n      .data((layer) => layer)\n      .join('rect')\n      .style('transform', 'scale(1, -1)')\n      .attr('x', (seq) => xScale.bandwidth() / 2 - 3 + xScale(seq.data.text))\n      .attr('y', -height + 15)\n      .attr('width', 6)\n      .attr('height', (seq) => yScale(seq[1]) - yScale(seq[0]));\n\n    // group\n    //   .selectAll('.bar')\n    //   .data(data)\n    //   .join('rect')\n    //   .attr('class', 'bar')\n    //   .style('transform', 'scale(1, -1)')\n    //   .attr('x', (d) => xScale.bandwidth() / 2 - 3 + xScale(d.text))\n    //   .attr('y', -height + 15)\n    //   .attr('width', 6)\n    //   .attr('height', 0)\n    //   .attr('fill', (d) => (d.amount < 0 ? colorList[0] : colorList[1]))\n    //   .transition()\n    //   .duration(1000)\n    //   .attr('height', (d) => yScale(Math.abs(d.amount)));\n\n    // eslint-disable-next-line\n  }, [data]);\n\n  return (\n    <svg\n      width={width}\n      height={height}\n      ref={ref}\n      style={{ margin: 'auto', overflow: 'visible' }}\n    >\n      <g className='x-axis' />\n    </svg>\n  );\n};\n\nexport default BarChart;\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"var _jsxFileName = \"/Users/Min/Desktop/expense-tracker/client/src/components/common/BarChart.jsx\";\nimport React, { useEffect, useRef } from 'react'; // import * as d3 from 'd3';\n\nimport { select, max, stack, stackOrderReverse, scaleLinear, scaleBand, axisBottom } from 'd3';\nimport moment from 'moment';\n\nconst BarChart = ({\n  data,\n  keys,\n  select,\n  width,\n  height\n}) => {\n  const ref = useRef(null);\n  const colorList = {\n    income: '#fff',\n    expense: '#f8777d'\n  };\n  const dayList = moment.weekdays();\n  const monthList = moment.months();\n  const weekList = [];\n  const monthRange = moment.range(moment().startOf('month'), moment().endOf('month'));\n\n  for (let mday of monthRange.by('days')) {\n    if (weekList.indexOf(mday.week()) === -1) {\n      weekList.push('Week ' + mday.week());\n    }\n  }\n\n  useEffect(() => {\n    const group = select(ref.current);\n    const labels = select === 0 ? dayList : select === 1 ? weekList : monthList;\n    data.forEach(data => data['expense'] = Math.abs(data['expense']));\n    const stackGenerator = stack().keys(keys).order(stackOrderReverse);\n    const layers = stackGenerator(data);\n    const MaxAmount = max(layers, layer => max(layer, seq => Math.abs(seq[1])));\n    const extent = [0, MaxAmount];\n    const yScale = scaleLinear().domain(extent).range([height, 0]);\n    const xScale = scaleBand().domain(labels).range([0, width]);\n    const xAxis = axisBottom(xScale).tickSize(0);\n    group.select('.x-axis').style('transform', `translateY(${height}px)`).style('color', 'white').call(xAxis).call(g => g.select('.domain').remove()).selectAll('.x-axis .tick text').call(t => t.each(function (d) {\n      const self = select(this);\n      self.text('');\n      self.append('tspan').attr('dy', '1em').text(select === 1 ? d : d.slice(0, 3));\n    }));\n    group.selectAll('.layer').data(layers).join('g').attr('class', 'layer').attr('fill', layer => colorList[layer.key]).selectAll('rect').data(layer => layer).join('rect').attr('x', seq => xScale.bandwidth() / 2 - 3 + xScale(seq.data.text)).attr('width', 6).attr('y', height).attr('height', 0).transition().duration(1000).attr('y', seq => yScale(seq[1])).attr('height', seq => yScale(seq[0]) - yScale(seq[1])); // eslint-disable-next-line\n  }, [data]);\n  return React.createElement(\"svg\", {\n    width: width,\n    height: height,\n    ref: ref,\n    style: {\n      margin: 'auto',\n      overflow: 'visible'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  }, React.createElement(\"g\", {\n    className: \"x-axis\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82\n    },\n    __self: this\n  }));\n};\n\nexport default BarChart;","map":{"version":3,"sources":["/Users/Min/Desktop/expense-tracker/client/src/components/common/BarChart.jsx"],"names":["React","useEffect","useRef","select","max","stack","stackOrderReverse","scaleLinear","scaleBand","axisBottom","moment","BarChart","data","keys","width","height","ref","colorList","income","expense","dayList","weekdays","monthList","months","weekList","monthRange","range","startOf","endOf","mday","by","indexOf","week","push","group","current","labels","forEach","Math","abs","stackGenerator","order","layers","MaxAmount","layer","seq","extent","yScale","domain","xScale","xAxis","tickSize","style","call","g","remove","selectAll","t","each","d","self","text","append","attr","slice","join","key","bandwidth","transition","duration","margin","overflow"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef } from 'react';\n// import * as d3 from 'd3';\nimport { select, max, stack, stackOrderReverse, scaleLinear, scaleBand, axisBottom } from 'd3';\nimport moment from 'moment';\n\nconst BarChart = ({ data, keys, select, width, height }) => {\n  const ref = useRef(null);\n  const colorList = { income: '#fff', expense: '#f8777d' };\n  const dayList = moment.weekdays();\n  const monthList = moment.months();\n  const weekList = [];\n  const monthRange = moment.range(\n    moment().startOf('month'),\n    moment().endOf('month')\n  );\n  for (let mday of monthRange.by('days')) {\n    if (weekList.indexOf(mday.week()) === -1) {\n      weekList.push('Week ' + mday.week());\n    }\n  }\n\n  useEffect(() => {\n    const group = select(ref.current);\n    const labels = select === 0 ? dayList : select === 1 ? weekList : monthList;\n\n    data.forEach((data) => (data['expense'] = Math.abs(data['expense'])));\n    const stackGenerator = stack().keys(keys).order(stackOrderReverse);\n    const layers = stackGenerator(data);\n    const MaxAmount = max(layers, (layer) => max(layer, (seq) => Math.abs(seq[1])));\n    const extent = [0, MaxAmount];\n\n    const yScale = scaleLinear().domain(extent).range([height, 0]);\n    const xScale = scaleBand().domain(labels).range([0, width]);\n    const xAxis = axisBottom(xScale).tickSize(0);\n\n    group\n      .select('.x-axis')\n      .style('transform', `translateY(${height}px)`)\n      .style('color', 'white')\n      .call(xAxis)\n      .call((g) => g.select('.domain').remove())\n      .selectAll('.x-axis .tick text')\n      .call((t) =>\n        t.each(function (d) {\n          const self = select(this);\n          self.text('');\n          self\n            .append('tspan')\n            .attr('dy', '1em')\n            .text(select === 1 ? d : d.slice(0, 3));\n        })\n      );\n\n    group\n      .selectAll('.layer')\n      .data(layers)\n      .join('g')\n      .attr('class', 'layer')\n      .attr('fill', (layer) => colorList[layer.key])\n      .selectAll('rect')\n      .data((layer) => layer)\n      .join('rect')\n      .attr('x', (seq) => xScale.bandwidth() / 2 - 3 + xScale(seq.data.text))\n      .attr('width', 6)\n      .attr('y', height)\n      .attr('height', 0)\n      .transition()\n      .duration(1000)\n      .attr('y', (seq) => yScale(seq[1]))\n      .attr('height', (seq) => yScale(seq[0]) - yScale(seq[1]));\n\n    // eslint-disable-next-line\n  }, [data]);\n\n  return (\n    <svg\n      width={width}\n      height={height}\n      ref={ref}\n      style={{ margin: 'auto', overflow: 'visible' }}\n    >\n      <g className='x-axis' />\n    </svg>\n  );\n};\n\nexport default BarChart;\n"]},"metadata":{},"sourceType":"module"}